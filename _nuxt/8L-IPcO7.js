import{g as R,r as g,k as p,z as I,c as i,o as s,a as u,p as f,a4 as z,n as y,F as v,h as B,t as h,d as A,m as P,_ as D}from"./D3dCSwSP.js";const E={class:"c-input-image"},q={class:"c-inpType"},U=["for"],G={key:0,class:"required-mark"},K={key:1},W={key:0,class:"image-preview-container"},j=["src","alt"],H=["onClick"],J={class:"file-input-area"},O=["id","disabled"],Q=["disabled"],X={key:1},Y={key:1,class:"feedback error"},Z={class:"text"},_={key:2,class:"help-text"},ee=R({__name:"InputImage",props:{label:{type:String,default:""},labelSize:{type:String,default:"1.2rem"},labelClass:{type:String,default:""},name:{type:String,default:""},modelValue:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!1},maxFiles:{type:Number,default:null},maxFileSize:{type:Number,default:5*1024*1024},disabled:{type:Boolean,default:!1},isInvalid:{type:Boolean,default:!1},validText:{type:String,default:"이미지 업로드 오류"},helpText:{type:String,default:""},uploadButtonText:{type:String,default:""},showIcon:{type:Boolean,default:!0},iconType:{type:String,default:"ico-image"},iconSize:{type:String,default:"2.4rem"},size:{type:String,validator:e=>["lg","sm","normal"].includes(e),default:"normal"},showPreview:{type:Boolean,default:!0},currentImageCount:{type:Number,default:0},enableLimitCheck:{type:Boolean,default:!1}},emits:["update:modelValue","file-selected","file-removed","error"],setup(e,{emit:C}){const t=e,r=C,b=g(),d=g([]),m=g([]),k=p(()=>`image-input-${Math.random().toString(36).substr(2,9)}`),x=p(()=>t.label.includes("*")),w=p(()=>x.value?t.label.split("*"):[t.label]),T=l=>{const o=l.target,n=o.files;if(!n||n.length===0)return;const a=Array.from(n);if(t.maxFiles&&t.modelValue.length+a.length>t.maxFiles){r("error",`최대 ${t.maxFiles}개까지 업로드 가능합니다.`);return}for(const c of a){if(!c.type.startsWith("image/")){r("error","이미지 파일만 업로드 가능합니다.");return}if(c.size>t.maxFileSize){r("error",`파일 크기는 ${L(t.maxFileSize)} 이하여야 합니다.`);return}}d.value.push(...a),a.forEach(c=>{const F=new FileReader;F.onload=N=>{var S;m.value.push((S=N.target)==null?void 0:S.result)},F.readAsDataURL(c)}),r("update:modelValue",[...d.value]),r("file-selected",a),o.value=""},V=()=>{var l;if(t.enableLimitCheck&&t.maxFiles&&t.currentImageCount>=t.maxFiles){r("error",`최대 ${t.maxFiles}개까지 업로드 가능합니다.`);return}(l=b.value)==null||l.click()},M=()=>{if(t.enableLimitCheck&&t.maxFiles&&t.currentImageCount>=t.maxFiles){r("error",`최대 ${t.maxFiles}개까지 업로드 가능합니다.`);return}},$=l=>{d.value.splice(l,1),m.value.splice(l,1),r("update:modelValue",[...d.value]),r("file-removed",l)},L=l=>{if(l===0)return"0 Bytes";const o=1024,n=["Bytes","KB","MB","GB"],a=Math.floor(Math.log(l)/Math.log(o));return parseFloat((l/Math.pow(o,a)).toFixed(2))+" "+n[a]};return I(()=>t.modelValue,l=>{l.length!==d.value.length&&(d.value=[...l],m.value=[],l.forEach(o=>{const n=new FileReader;n.onload=a=>{var c;m.value.push((c=a.target)==null?void 0:c.result)},n.readAsDataURL(o)}))},{deep:!0}),I(()=>t.modelValue,l=>{d.value=[...l]},{immediate:!0}),(l,o)=>(s(),i("div",E,[u("div",q,[e.label?(s(),i("label",{key:0,for:k.value,class:y(["c-label",e.labelClass]),style:z({fontSize:e.labelSize})},[x.value?(s(!0),i(v,{key:0},B(w.value,(n,a)=>(s(),i("span",{key:a},[n==="*"?(s(),i("span",G,"*")):(s(),i("span",K,h(n),1))]))),128)):(s(),i(v,{key:1},[A(h(e.label),1)],64))],14,U)):f("",!0),u("div",{class:y(["c-inp-el",{lg:t.size==="lg",sm:t.size==="sm"}])},[e.showPreview&&m.value.length>0?(s(),i("div",W,[(s(!0),i(v,null,B(m.value,(n,a)=>(s(),i("div",{key:a,class:"image-preview-item"},[u("img",{src:n,alt:`미리보기 이미지 ${a+1}`},null,8,j),u("button",{type:"button",class:"remove-image-btn",onClick:c=>$(a),"aria-label":"이미지 제거"},o[0]||(o[0]=[u("i",{class:"icon ico-close"},null,-1)]),8,H)]))),128))])):f("",!0),u("div",J,[u("input",P({id:k.value,ref_key:"fileInput",ref:b,type:"file",accept:"image/*"},e.multiple?{multiple:!0}:{},{disabled:e.disabled,class:["c-file-inp",{"is-invalid":e.isInvalid}],onChange:T,onClick:M}),null,16,O),u("button",{type:"button",class:"upload-btn",disabled:e.disabled||e.maxFiles&&m.value.length>=e.maxFiles,onClick:V},[e.showIcon?(s(),i("i",{key:0,class:y(["icon",e.iconType]),style:z({width:e.iconSize,height:e.iconSize})},null,6)):f("",!0),e.uploadButtonText?(s(),i("span",X,h(e.uploadButtonText),1)):f("",!0)],8,Q)])],2),e.isInvalid?(s(),i("p",Y,[u("span",Z,h(e.validText),1)])):f("",!0),e.helpText?(s(),i("p",_,h(e.helpText),1)):f("",!0)])]))}}),le=D(ee,[["__scopeId","data-v-be3196c6"]]);export{le as I};
