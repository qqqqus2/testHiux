import{g as F,c as d,o as u,a,n as ot,_ as U,r,p as y,d as D,e as V,u as o,b as it,F as I,h as B,t as M,A as ut,l as rt,x as ct,ab as H,j as dt,a4 as ht,a1 as A}from"./D3dCSwSP.js";import{u as vt,E as pt}from"./DEtWHC6Z.js";const gt={class:"toolbar"},ft=["disabled","title"],mt=F({__name:"EditorToolbar",props:{editor:{},hashtag:{},star:{},healthData:{},imageCount:{}},emits:["image-upload","hashtag","star","health-data"],setup(W){return(c,i)=>(u(),d("div",gt,[a("button",{class:ot(["toolbar-btn",{disabled:(c.imageCount||0)>=5}]),disabled:(c.imageCount||0)>=5,title:(c.imageCount||0)>=5?"최대 5개의 이미지까지 업로드할 수 있습니다.":"이미지 업로드",onClick:i[0]||(i[0]=h=>c.$emit("image-upload"))}," 📷 ",10,ft),a("button",{class:"toolbar-btn",onClick:i[1]||(i[1]=h=>c.$emit("hashtag"))},"#"),a("button",{class:"toolbar-btn",onClick:i[2]||(i[2]=h=>c.$emit("star"))},"⭐"),a("button",{class:"toolbar-btn",onClick:i[3]||(i[3]=h=>c.$emit("health-data"))},"❤️")]))}}),bt=U(mt,[["__scopeId","data-v-e97e6db1"]]),yt={class:"editor-container"},_t={key:1,class:"health-section"},kt={class:"editor-content-wrapper"},Ct={class:"editor-main"},St={class:"hashtag-container"},wt=["onClick"],$t={key:0,class:"hashtag-input-container"},Ht={key:1,class:"star-section"},Rt={class:"star-container"},Tt={class:"star-rating"},Et=["onMousemove","onTouchmove","onClick"],Dt={class:"star-score"},It={key:2,class:"image-sidebar"},Bt={class:"image-container"},At={class:"image-container"},Ft={class:"image-wrapper"},Wt=["src","alt"],Mt=["onClick"],Ut=F({__name:"Editor",setup(W){const{editor:c}=vt(),i=r(null),h=r([]),b=r(null),g=r([]),f=r(!1),n=r(""),w=r(!1),m=r(0),R=r(!1),v=r(0),_=r(!1),T=r({}),k=r(!1),z=()=>{var t;if(h.value.length>=5){alert("최대 5개의 이미지까지 업로드할 수 있습니다.");return}(t=i.value)==null||t.click()},N=t=>{h.value.splice(t,1)},L=t=>{const e=t.target.files;if(!e||e.length===0)return;const l=5-h.value.length;if(l<=0){alert("최대 5개의 이미지까지 업로드할 수 있습니다.");return}const p=Array.from(e).slice(0,l);e.length>p.length&&alert(`${p.length}개의 이미지만 업로드됩니다. (최대 5개 제한)`),p.forEach(C=>{const S=new FileReader;S.onload=()=>{const nt=S.result;h.value.push(nt)},S.readAsDataURL(C)}),i.value&&(i.value.value="")},j=()=>{w.value=!w.value,w.value?(f.value=!0,A(()=>{var t;(t=b.value)==null||t.focus(),n.value="",$()})):(g.value=[],f.value=!1,n.value="")},x=()=>{f.value||(f.value=!0,A(()=>{var t;(t=b.value)==null||t.focus(),$()}))},K=()=>{if(n.value.trim()){const t=n.value.trim().replace(/^#/,"");t&&t.length<=10&&!g.value.includes(t)&&g.value.push(t)}n.value="",f.value=!1},E=()=>{if(n.value.trim()){const t=n.value.trim().replace(/^#/,"");t&&t.length<=10&&!g.value.includes(t)&&g.value.push(t)}n.value="",A(()=>{var t;(t=b.value)==null||t.focus(),$()})},X=()=>{n.value="",f.value=!1},P=()=>{if(n.value.endsWith(" ")){n.value=n.value.trim(),E();return}$()},$=()=>{if(b.value){const t=b.value,e=n.value||"";if(e.length===0)t.style.width="10px";else{const s=document.createElement("span"),l=getComputedStyle(t);s.style.visibility="hidden",s.style.position="absolute",s.style.fontSize=l.fontSize,s.style.fontWeight=l.fontWeight,s.style.fontFamily=l.fontFamily,s.style.whiteSpace="pre",s.textContent=e,document.body.appendChild(s);const p=s.offsetWidth;document.body.removeChild(s),t.style.width=`${p+8}px`}}},q=()=>{n.value===""&&g.value.length>0&&g.value.pop()},G=t=>{g.value.splice(t,1)},J=()=>{_.value=!_.value,_.value?R.value=!0:(m.value=0,R.value=!1,v.value=0)},O=()=>{_.value=!1,m.value=0,R.value=!1,v.value=0},Q=(t,e)=>{const s=t.target.getBoundingClientRect(),l=t.clientX-s.left,p=s.width,C=l<p/2;v.value=C?e-.5:e},Y=()=>{v.value=0},Z=(t,e)=>{t.preventDefault();const s=t.touches[0],l=t.target.getBoundingClientRect(),p=s.clientX-l.left,C=l.width,S=p<C/2;v.value=S?e-.5:e},tt=()=>{v.value>0&&(m.value=v.value)},et=t=>{m.value=v.value>0?v.value:t},at=t=>{const e=v.value>0?v.value:m.value;return t<=e?"100%":t-.5<=e?"50%":"0%"},st=()=>{k.value=!k.value,k.value||(T.value={})},lt=()=>{k.value=!1,T.value={}};return(t,e)=>(u(),d("div",null,[e[7]||(e[7]=a("h1",null,"TipTap 에디터",-1)),e[8]||(e[8]=a("p",{class:"description"},[D("해시태그 : 최대 10자, #과 공백 제외 모든 문자 허용 "),a("br"),D("엔터또는 스페이스바로 생성")],-1)),e[9]||(e[9]=a("p",{class:"description"},"별점 : 최대 5점(0.5점 단위)",-1)),e[10]||(e[10]=a("p",{class:"description"},"이미지 : 최대 5개 스와이프 기능 제공",-1)),e[11]||(e[11]=a("p",{class:"description"},"건강 데이터 : 추후 추가 예정 (기획 안나옴)",-1)),a("div",yt,[o(c)?(u(),V(bt,{key:0,editor:o(c),hashtag:o(g),star:o(m),"health-data":o(T),"image-count":o(h).length,onImageUpload:z,onHashtag:j,onStar:J,onHealthData:st},null,8,["editor","hashtag","star","health-data","image-count"])):y("",!0),o(k)?(u(),d("div",_t,[a("div",{class:"health-header"},[e[1]||(e[1]=a("h3",{class:"health-title"},"건강 데이터",-1)),a("button",{class:"health-close",onClick:lt},"×")]),e[2]||(e[2]=a("div",{class:"health-container"},[a("p",{class:"health-placeholder"},"건강 데이터 요소들")],-1))])):y("",!0),a("div",kt,[a("div",Ct,[it(o(pt),{editor:o(c)},null,8,["editor"]),a("input",{ref_key:"fileInputRef",ref:i,type:"file",accept:"image/*",multiple:"",class:"hidden",onChange:L},null,544)])])]),o(w)?(u(),d("div",{key:0,class:"hashtag-section",onClick:x},[a("div",St,[(u(!0),d(I,null,B(o(g),(s,l)=>(u(),d("span",{key:l,class:"hashtag-item"},[D(" #"+M(s)+" ",1),a("button",{class:"hashtag-delete",onClick:ut(p=>G(l),["stop"])},"×",8,wt)]))),128)),o(f)?(u(),d("div",$t,[e[3]||(e[3]=a("span",{class:"hashtag-hash"},"#",-1)),rt(a("input",{ref_key:"hashtagInputRef",ref:b,"onUpdate:modelValue":e[0]||(e[0]=s=>dt(n)?n.value=s:null),type:"text",class:"hashtag-input",maxlength:"9",onKeydown:[H(E,["enter"]),H(E,["space"]),H(q,["backspace"]),H(X,["esc"])],onInput:P,onBlur:K},null,544),[[ct,o(n)]])])):y("",!0)])])):y("",!0),o(_)?(u(),d("div",Ht,[a("div",{class:"star-header"},[e[4]||(e[4]=a("h3",{class:"star-title"},"별점",-1)),a("button",{class:"star-close",onClick:O},"×")]),a("div",Rt,[a("div",Tt,[(u(),d(I,null,B(5,s=>a("div",{key:s,class:"star-wrapper",onMousemove:l=>Q(l,s),onMouseleave:Y,onTouchmove:l=>Z(l,s),onTouchend:tt,onClick:l=>et(s)},[e[5]||(e[5]=a("div",{class:"star-bg"},"☆",-1)),a("div",{class:"star-fill",style:ht({width:at(s)})},"★",4)],40,Et)),64))]),a("div",Dt,M(o(m).toFixed(1)),1)])])):y("",!0),o(h).length>0?(u(),d("div",It,[a("div",Bt,[a("div",At,[(u(!0),d(I,null,B(o(h),(s,l)=>(u(),d("div",{key:l,class:"image-item"},[a("div",Ft,[a("img",{src:s,alt:`업로드된 이미지 ${l+1}`,class:"uploaded-image"},null,8,Wt),a("button",{class:"image-delete-btn",onClick:p=>N(l)},e[6]||(e[6]=[a("i",{class:"ri-close-fill"},null,-1)]),8,Mt)])]))),128))])])])):y("",!0)]))}}),Vt=U(Ut,[["__scopeId","data-v-26d27cef"]]),Lt=F({__name:"index",setup(W){return(c,i)=>(u(),V(Vt))}});export{Lt as default};
