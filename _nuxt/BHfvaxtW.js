import{_ as ee}from"./CgQ5lQtw.js";import{g as G,r as s,k as te,c as S,o as h,b as d,a as g,e as P,w as x,F as Y,h as le,a4 as ne,n as ae,p as oe,t as ue,A as B,aq as re,a7 as ie,_ as X}from"./CEJX9E6Q.js";import{F as se}from"./BAc-8hQK.js";import{F as ce}from"./CIo5sv1j.js";import{F as ve}from"./CV-31FcE.js";import{C as de}from"./BEadg-pj.js";import"./CBkOwUYj.js";import{_ as fe}from"./Dk0J2JMS.js";import{I as E}from"./DhiuaYuY.js";import{B as me}from"./CFdCBK2j.js";import{I as pe}from"./CgaxpIzC.js";import"./x_rD_Ya3.js";/* empty css        *//* empty css        */const ge={class:"family-group"},he={class:"group-list",ref:"groupList"},xe=["data-index","onDragstart","onDragover","onDrop","onTouchstart"],be={class:"tit"},_e={class:"modify-btns"},Ie=["onClick","onTouchend"],ye=-999,we=G({__name:"ManageFamilyGroup",setup(A){const F=async t=>{try{await de.open({isVisible:!0,html:`
<div style="min-width:24rem; display: flex; flex-direction: column; gap: 1rem; text-align: center">
  <div style="font-weight: bold; font-size: 1.8rem; color: #2b2b2b;">그룹을 삭제하시겠습니까?</div>
<div style="font-size: 1.4rem; color: #666; margin-top: 0.5rem;">
    운영자가 그룹을 삭제할 경우,<br /> 그룹에 있는 모든내용이 삭제됩니다.
    </div>
      </div>`,confirmButtonText:"삭제하기",cancelButtonText:"취소하기"})&&i.value.splice(t,1)}catch(e){console.error(e)}},I=s(!1),L=()=>{$()},$=()=>{I.value=!I.value},i=s([{id:1,name:"우리집"},{id:2,name:"동네친구들"},{id:3,name:"베프"},{id:4,name:"디자인팀"}]),c=s(null),a=s(null),v=s(!1),u=s(null),k=s(0),M=s(0),b=s(null),y=s(0),R=s(0),_=s({position:"static",top:"0px",left:"0px",width:"auto",zIndex:1,pointerEvents:"auto",transform:"none"}),p=s(null),w=s(null),D=te(()=>{if(!v.value||u.value===null)return i.value;const t=[...i.value],e=t.find(l=>l.id===c.value);if(e&&a.value!==null){const l=t.filter(o=>o.id!==c.value);let n=u.value;return a.value<u.value&&(n=Math.max(0,n-1)),l.splice(n,0,{id:ye,name:"",isPreview:!0}),l.push(e),l}return t}),V=t=>{if(!v.value||u.value===null||a.value===null)return!1;const e=D.value[t];if(e.isPreview||e.id===c.value)return!1;const l=i.value.findIndex(n=>n.id===e.id);return a.value<u.value&&l>=a.value&&l<u.value},N=t=>{if(!v.value||u.value===null||a.value===null)return!1;const e=D.value[t];if(e.isPreview||e.id===c.value)return!1;const l=i.value.findIndex(n=>n.id===e.id);return a.value>u.value&&l>u.value&&l<=a.value},O=(t,e)=>t.id===c.value&&v.value?_.value:{},U=(t,e,l)=>{if(t.target.closest(".modify-btns")){t.preventDefault();return}c.value=e.id,a.value=i.value.findIndex(r=>r.id===e.id),v.value=!0,t.dataTransfer&&(t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",l.toString()));const f=t.target.closest(".group-item");if(f){p.value=f.getBoundingClientRect();const r=document.querySelector(".group-list");r&&(w.value=r.getBoundingClientRect())}},j=()=>{if(u.value!==null&&a.value!==null&&u.value!==a.value){const t=i.value.splice(a.value,1)[0];let e=u.value;a.value<u.value&&(e=e-1),i.value.splice(e,0,t)}c.value=null,a.value=null,u.value=null,v.value=!1,q()},H=(t,e)=>{if(t.preventDefault(),t.dataTransfer&&(t.dataTransfer.dropEffect="move"),c.value!==null&&a.value!==null){const l=t.clientY,n=document.querySelector(".group-list");if(n){const o=n.querySelectorAll(".group-item:not(.dragging):not(.drag-preview)");let f=0,r=!1;o.forEach(m=>{const C=m.getBoundingClientRect(),T=C.top+C.height/2;l<T&&!r?r=!0:r||f++}),f>a.value&&f++,u.value=Math.min(f,i.value.length)}}},J=(t,e)=>{t.preventDefault()},K=(t,e,l)=>{const n=t.target;if(n.closest(".modify-btns")||n.classList.contains("btn-modify"))return;t.preventDefault();const o=t.touches[0];k.value=o.clientY,M.value=o.clientX,b.value=i.value.findIndex(m=>m.id===e.id),c.value=e.id,a.value=b.value,v.value=!0;const r=t.target.closest(".group-item");if(r){p.value=r.getBoundingClientRect();const m=document.querySelector(".group-list");m&&(w.value=m.getBoundingClientRect(),_.value={position:"fixed",top:`${p.value.top*.1}rem`,left:`${p.value.left*.1}rem`,width:`${p.value.width*.1}rem`,zIndex:1e3,pointerEvents:"none",transform:"scale(1.05)"})}"vibrate"in navigator&&navigator.vibrate(50)},Q=t=>{if(!v.value||b.value===null||!p.value||!w.value)return;t.preventDefault();const e=t.touches[0];y.value=e.clientY,R.value=e.clientX;const l=y.value-k.value,n=R.value-M.value;_.value={..._.value,top:`${p.value.top+l}px`,left:`${p.value.left+n}px`};const o=document.querySelector(".group-list");if(o){const f=o.querySelectorAll(".group-item:not(.touch-dragging):not(.drag-preview)");let r=0,m=!1;f.forEach(C=>{const T=C.getBoundingClientRect(),Z=T.top+T.height/2;y.value<Z&&!m?m=!0:m||r++}),a.value!==null&&r>a.value&&r++,u.value=Math.min(r,i.value.length)}},W=t=>{if(t.preventDefault(),!(!v.value||b.value===null)){if(u.value!==null&&a.value!==null&&u.value!==a.value){const e=i.value.splice(a.value,1)[0];let l=u.value;a.value<u.value&&(l=l-1),i.value.splice(l,0,e)}v.value=!1,c.value=null,a.value=null,b.value=null,u.value=null,k.value=0,M.value=0,y.value=0,R.value=0,q()}},q=()=>{_.value={position:"static",top:"0px",left:"0px",width:"auto",zIndex:1,pointerEvents:"auto",transform:"none"},p.value=null,w.value=null},z=async t=>{try{const e=D.value[t];if(e&&!e.isPreview){const l=i.value.findIndex(n=>n.id===e.id);l!==-1&&await F(l)}}catch(e){console.error("Error in deleteGroup:",e)}};return(t,e)=>(h(),S("div",ge,[d(ve,{class:"gap-8 mb-16"},{default:x(()=>[d(E,{placeholder:"그룹 이름을 입력해 주세요."}),d(me,{"btn-type":"primary","element-type":"button","aria-label":"확인",width:8,class:"flex-00"})]),_:1}),g("div",he,[d(re,{name:"list-move"},{default:x(()=>[(h(!0),S(Y,null,le(D.value,(l,n)=>(h(),S("div",{key:l.id,class:ae(["group-item",{dragging:l.id===c.value,"touch-dragging":v.value&&l.id===c.value,"drag-preview":l.isPreview,"shift-down":V(n),"shift-up":N(n)}]),style:ne(O(l,n)),"data-index":n,draggable:"true",onDragstart:o=>U(o,l,n),onDragend:j,onDragover:o=>H(o,n),onDrop:o=>J(o,n),onTouchstart:o=>K(o,l,n),onTouchmove:e[0]||(e[0]=o=>Q(o)),onTouchend:e[1]||(e[1]=o=>W(o))},[l.isPreview?oe("",!0):(h(),S(Y,{key:0},[e[2]||(e[2]=g("button",{type:"button",class:"btn-move-list",title:"순서 변경"},null,-1)),g("strong",be,ue(l.name),1),g("div",_e,[g("button",{type:"button",class:"btn-modify",onClick:B(L,["stop","prevent"]),onTouchend:B(L,["stop","prevent"])}," 이름바꾸기 ",32),g("button",{type:"button",class:"btn-modify",onClick:B(o=>z(n),["stop","prevent"]),onTouchend:B(o=>z(n),["stop","prevent"])}," 삭제 ",40,Ie)])],64))],46,xe))),128))]),_:1})],512),(h(),P(ie,{to:"body"},[d(fe,{"is-visible":I.value,title:"그룹 이름 수정하기","is-show-close-button":!0,"confirm-button-text":"수정하기","cancel-button-text":"취소하기",onClose:$},{content:x(()=>[d(se,{class:"text-left gap-20 pb-16"},{default:x(()=>[d(E,{label:"기존 그룹 이름",disabled:!0}),d(ce,{class:"gap-6"},{default:x(()=>[d(pe,{label:"수정할 그룹 이름"}),d(E,{disabled:!0})]),_:1})]),_:1})]),_:1},8,["is-visible"])]))]))}}),De=X(we,[["__scopeId","data-v-7451c1a9"]]),Ce=G({__name:"group",setup(A){return(F,I)=>(h(),P(ee,{"show-back-button":!0,"page-title":"그룹 관리"},{default:x(()=>[d(De)]),_:1}))}}),Pe=X(Ce,[["__scopeId","data-v-c4ad53e2"]]);export{Pe as default};
