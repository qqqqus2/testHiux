import{g as oe,r as l,q as le,z as ae,s as ie,Z as ne,e as U,w as y,y as re,o as d,a as n,b as r,p as w,c as p,t as B,F as ue,h as ce,n as de,d as z,_ as me}from"./CEJX9E6Q.js";import{_ as ve}from"./CgQ5lQtw.js";import{D as A}from"./qGuR-Jn_.js";import{F as P}from"./CIo5sv1j.js";import{D as ge,a as fe,E as pe}from"./DXIw8x5b.js";import{C as be}from"./CR-Xt0lD.js";import{B as ye}from"./B1NgK7rn.js";import{_ as we}from"./Dk0J2JMS.js";import{B as he}from"./CFdCBK2j.js";import{B as je}from"./CyEs641m.js";import"./BOHLvpOl.js";/* empty css        *//* empty css        */import"./DgMA-dYW.js";import"./DTDnaLW0.js";import"./vCy60rdo.js";/* empty css        *//* empty css        */const De={class:"date-label"},ke={key:0,class:"daily-quote-title"},Ce=["innerHTML"],xe={key:1,class:"emoji-box"},Ve=["src","alt"],Ee={key:1},Se={key:0,class:"image-preview-section"},Fe={class:"image-preview-container"},Me=["src","alt"],qe=["onClick"],Ie=oe({__name:"create",setup(_e){const J=re(),u=le(),m=l(new Date(u.query.date||new Date)),i=l(null),C=l(""),v=l([]),T=l(null),V=l(!1),x=l(!1),E=l(null),b=l(!1),q=l(""),h=l(!1),S=l(!1),$=l(""),L=l(!1),j=l(0),f=l(!1),F=[{src:"/assets/images/emoji/happy.svg",label:"í–‰ë³µ"},{src:"/assets/images/emoji/peaceful.svg",label:"í‰ì˜¨"},{src:"/assets/images/emoji/excited.svg",label:"ì„¤ë ˜"},{src:"/assets/images/emoji/sad.svg",label:"ìŠ¬í””"},{src:"/assets/images/emoji/angry.svg",label:"í™”ë‚¨"},{src:"/assets/images/emoji/upset.svg",label:"ì†ìƒ"},{src:"/assets/images/emoji/indifferent.svg",label:"ë¤ë¤"},{src:"/assets/images/emoji/fun.svg",label:"ì¬ë¯¸"},{src:"/assets/images/emoji/surprise.svg",label:"ë†€ëŒ"},{src:"/assets/images/emoji/worry.svg",label:"ê±±ì •"},{src:"/assets/images/emoji/hurt.svg",label:"ì•„íŒŒ"},{src:"/assets/images/emoji/embarrassed.svg",label:"ì°½í”¼"},{src:"/assets/images/emoji/flustered.svg",label:"ë‹¹í™©"},{src:"/assets/images/emoji/frustrated.svg",label:"ë‹µë‹µ"},{src:"/assets/images/emoji/annoyed.svg",label:"ì§œì¦"},{src:"/assets/images/emoji/ruined.svg",label:"ë§í•¨"},{src:"/assets/images/emoji/shocked.svg",label:"í—"},{src:"/assets/images/emoji/thrilled.svg",label:"ì‹ ë‚¨"},{src:"/assets/images/emoji/cheer.svg",label:"ì‘ì›"},{src:"/assets/images/emoji/congrats.svg",label:"ì¶•í•˜"},{src:"/assets/images/emoji/touched.svg",label:"ê°ë™"}],R=()=>{if(u.query.edit==="true"&&u.query.id){x.value=!0,E.value=Number(u.query.id);const e=JSON.parse(localStorage.getItem("diaryList")||"[]").find(s=>s.id===E.value);e&&(m.value=new Date(e.date),i.value=e.emoji,C.value=e.content,v.value=e.images||[])}};ae(()=>u.query,(t,e)=>{if(console.log("ë°›ì€ ì¿¼ë¦¬:",t),console.log("ì´ì „ ì¿¼ë¦¬:",e),t.type==="daily-quote"){if(b.value=!0,q.value=t.question,t.emoji){const s=t.emoji;console.log("daily-quote ëª¨ë“œì—ì„œ ì°¾ì„ ì´ëª¨ì§€:",s);const o=F.find(c=>{const a=c.src.split("/").pop(),g=a==null?void 0:a.replace(".svg",""),k=s.replace(".svg","");return console.log("ë¹„êµ:",{fileNameWithoutExt:g,emojiFileWithoutExt:k,matches:g===k}),g===k});o?(i.value=o,console.log("daily-quote ëª¨ë“œì—ì„œ ì´ëª¨ì§€ ì„¤ì • ì™„ë£Œ:",o)):(console.log("daily-quote ëª¨ë“œì—ì„œ ì´ëª¨ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ:",s),console.log("ì‚¬ìš© ê°€ëŠ¥í•œ ì´ëª¨ì§€:",F.map(c=>{var a;return(a=c.src.split("/").pop())==null?void 0:a.replace(".svg","")})))}return}if(b.value=!1,t.emoji&&t.name){const s=t.emoji,o=t.name;console.log("ì°¾ì„ ì´ëª¨ì§€:",{emojiFile:s,emojiName:o});const c=F.find(a=>{var O;const g=(O=a.src.split("/").pop())==null?void 0:O.replace(".svg",""),k=s.replace(".svg",""),N=g===k||a.label===o;return console.log("ë§¤ì¹­ í™•ì¸:",{fileName:g,emojiFileWithoutExt:k,emojiLabel:a.label,matches:N}),N});c?(e&&(e.emoji!==t.emoji||e.name!==t.name)&&(console.log("ì´ëª¨ì§€ ë³€ê²½ ê°ì§€: ê¸°ì¡´ ë‚´ìš©ê³¼ ì´ë¯¸ì§€ ë³´ì¡´"),console.log("ê¸°ì¡´ ë‚´ìš©:",C.value),console.log("ê¸°ì¡´ ì´ë¯¸ì§€ ê°œìˆ˜:",v.value.length)),i.value=c,console.log("ì´ëª¨ì§€ ì—…ë°ì´íŠ¸:",c)):(console.log("ì´ëª¨ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ:",{emojiFile:s,emojiName:o}),console.log("ì‚¬ìš© ê°€ëŠ¥í•œ ì´ëª¨ì§€:",F.map(a=>{var g;return{file:(g=a.src.split("/").pop())==null?void 0:g.replace(".svg",""),label:a.label}})))}},{immediate:!0,deep:!0});const I=t=>{m.value=t,M.value=!1},_=()=>{console.log("=== showSaveConfirm í˜¸ì¶œë¨ ==="),console.log("í˜„ì¬ showConfirmModal.value:",h.value),h.value=!0,console.log("ë³€ê²½ í›„ showConfirmModal.value:",h.value),console.log("=== showSaveConfirm ì™„ë£Œ ===")},W=()=>{if(v.value.length>3){D("ì‚¬ì§„ì€ ìµœëŒ€ 3ì¥ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.");return}const t={id:x.value?E.value:Date.now(),date:m.value.toISOString().split("T")[0],emoji:i.value,content:C.value.trim(),images:v.value,isDailyQuote:b.value,dailyQuoteQuestion:b.value?q.value:void 0,createdAt:x.value?new Date().toISOString():new Date().toISOString()};console.log("ì €ì¥í•  ë‹¤ì´ì–´ë¦¬ ë°ì´í„°:",t);let e=[];try{const s=localStorage.getItem("diaryList");e=s?JSON.parse(s):[]}catch(s){console.error("localStorageì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜:",s),e=[]}if(x.value){const s=e.findIndex(o=>o.id===E.value);s!==-1&&(e[s]=t)}else e.push(t);try{const s=JSON.stringify(e),o=new Blob([s]).size/(1024*1024);o>4&&(console.warn(`localStorage ë°ì´í„° í¬ê¸°ê°€ ${o.toFixed(2)}MBì…ë‹ˆë‹¤. ìš©ëŸ‰ ì œí•œì— ê·¼ì ‘í–ˆìŠµë‹ˆë‹¤.`),D("ì €ì¥ ê³µê°„ì´ ë¶€ì¡±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¼ë¶€ ì´ë¯¸ì§€ë¥¼ ì œê±°í•´ì£¼ì„¸ìš”.")),localStorage.setItem("diaryList",s),console.log("ë‹¤ì´ì–´ë¦¬ ì €ì¥ ì™„ë£Œ:",t)}catch(s){console.error("localStorageì— ì €ì¥í•˜ëŠ” ì¤‘ ì˜¤ë¥˜:",s),s instanceof Error&&s.name==="QuotaExceededError"?D("ì €ì¥ ê³µê°„ì´ ë¶€ì¡±í•©ë‹ˆë‹¤. ì¼ë¶€ ì´ë¯¸ì§€ë¥¼ ì œê±°í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."):D("ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");return}D("ì¼ê¸°ê°€ ê¸°ë¡ë˜ì—ˆìŠµë‹ˆë‹¤."),J.push("/community/diary/list")},D=t=>{$.value=t,S.value=!0,setTimeout(()=>{S.value=!1},3e3)},K=t=>{v.value.splice(t,1),T.value&&(T.value.value="")},G=t=>{console.log("ì´ëª¨ì§€ ì„ íƒë¨:",t),V.value=!1},Z=()=>{console.log("ğŸ¯ DiaryFieldset í¬ì»¤ìŠ¤ë¨ - ê°€ìƒ í‚¤íŒ¨ë“œê°€ ì—´ë¦´ ìˆ˜ ìˆìŒ"),console.log("ğŸ“± í¬ì»¤ìŠ¤ ìƒíƒœ ë³€ê²½:",f.value,"â†’",!0),f.value=!0},X=()=>{console.log("ğŸ”š DiaryFieldset ë¸”ëŸ¬ë¨ - ê°€ìƒ í‚¤íŒ¨ë“œê°€ ë‹«í ìˆ˜ ìˆìŒ"),console.log("ğŸ“± í¬ì»¤ìŠ¤ ìƒíƒœ ë³€ê²½:",f.value,"â†’",!1),f.value=!1},Y=()=>{console.log("ì™„ë£Œ ë²„íŠ¼ í´ë¦­ë¨ - í¬ì»¤ìŠ¤ ì•„ì›ƒ ì²˜ë¦¬"),f.value=!1,typeof document<"u"&&document.activeElement instanceof HTMLElement&&document.activeElement.blur()},H=ne("setAddTextClickHandler"),Q=()=>{if(typeof window<"u"&&"visualViewport"in window){const t=window.visualViewport;j.value===0&&(j.value=t.height);const e=j.value-t.height,s=j.value*.2;L.value=e>s,console.log("ê°€ìƒ í‚¤íŒ¨ë“œ ìƒíƒœ:",{isOpen:L.value,initialHeight:j.value,currentHeight:t.height,difference:e,threshold:s})}};ie(()=>{if(!u.query.type&&!u.query.emoji&&!u.query.name&&!i.value&&(i.value={src:"/assets/images/emoji/happy.svg",label:"í–‰ë³µ"}),u.query.edit==="true"&&u.query.id&&R(),H?(console.log("setAddTextClickHandler ì„¤ì •:",_),H(_)):console.error("setAddTextClickHandlerê°€ ì—†ìŠµë‹ˆë‹¤!"),typeof window<"u"&&"visualViewport"in window){const t=window.visualViewport;t.addEventListener("resize",Q),j.value=t.height}});const ee=t=>{const e=t.getMonth()+1,s=t.getDate(),c=["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "][t.getDay()];return`${e}ì›” ${s}ì¼ ${c}ìš”ì¼`},se=()=>{const t=new Date,e=[];for(let s=0;s<365;s++){const o=new Date(t);o.setDate(t.getDate()+s+1),e.push(o)}return e},M=l(!1),te=()=>{M.value=!0};return(t,e)=>(d(),U(ve,{"page-title":x.value?"ë§ˆìŒì¼ê¸° ìˆ˜ì •í•˜ê¸°":"ë§ˆìŒì¼ê¸° ë“±ë¡í•˜ê¸° ","show-back-button":!0},{default:y(()=>[n("section",null,[r(P,null,{default:y(()=>[n("div",{class:"date-display mt-20 mb-24",onClick:te},[r(A,{modelValue:m.value,"onUpdate:modelValue":[e[0]||(e[0]=s=>m.value=s),I],"show-header":!1,"show-navigation":!1,"show-calendar":!0,"show-time-picker":!1,class:"date-picker-display"},null,8,["modelValue"]),n("span",De,B(ee(m.value)),1)]),b.value?(d(),p("div",ke,[e[12]||(e[12]=n("span",null,"ì˜¤ëŠ˜ í•œë§ˆë””",-1)),n("p",{innerHTML:q.value},null,8,Ce)])):w("",!0),i.value||b.value?(d(),p("div",xe,[i.value?(d(),p("img",{key:0,src:i.value.src,alt:i.value.label},null,8,Ve)):w("",!0),i.value?(d(),p("p",Ee,"ì˜¤ëŠ˜ ë§ˆìŒì€ "+B(i.value.label)+"!",1)):w("",!0),b.value?w("",!0):(d(),p("button",{key:2,onClick:e[1]||(e[1]=s=>V.value=!0),class:"chage-btn"},e[13]||(e[13]=[n("span",null,"ê¸°ë¶„ ë°”ê¾¸ê¸°",-1),n("i",{class:"icon arrow-down-type"},null,-1)])))])):w("",!0)]),_:1}),r(P,{class:"pb-24"},{default:y(()=>[r(ge,{modelValue:C.value,"onUpdate:modelValue":e[2]||(e[2]=s=>C.value=s),onFocus:Z,onBlur:X},null,8,["modelValue"]),v.value.length>0?(d(),p("div",Se,[n("div",Fe,[(d(!0),p(ue,null,ce(v.value,(s,o)=>(d(),p("div",{key:o,class:"image-preview-item"},[n("img",{src:s,alt:`ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€ ${o+1}`},null,8,Me),n("button",{type:"button",class:"remove-image-btn",onClick:c=>K(o),"aria-label":"ì´ë¯¸ì§€ ì œê±°"},e[14]||(e[14]=[n("i",{class:"icon ico-close"},null,-1)]),8,qe)]))),128))])])):w("",!0)]),_:1}),r(fe,{modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=s=>v.value=s),class:de(["diary-image-uploader-fixed",{"is-focused":f.value}]),"register-button-text":f.value?"ì™„ë£Œ":"",onImageLimitExceeded:e[4]||(e[4]=()=>D("ì‚¬ì§„ì€ ìµœëŒ€ 3ì¥ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.")),onRegister:Y},null,8,["modelValue","class","register-button-text"]),f.value?w("",!0):(d(),U(je,{key:0,class:"is-fixed"},{default:y(()=>[r(he,{"btn-type":"primary","element-type":"button",class:"lg w-full medium btn-sticky",onClick:_},{default:y(()=>e[15]||(e[15]=[z(" ë“±ë¡í•˜ê¸° ")])),_:1,__:[15]})]),_:1}))]),r(pe,{"is-visible":V.value,"return-path":"/community/diary/create",onClose:e[5]||(e[5]=s=>V.value=!1),onEmojiSelected:G},null,8,["is-visible"]),r(be,{"is-visible":h.value,title:"ì¼ê¸° ë“±ë¡",content:"ì¼ê¸°ë¥¼ ë“±ë¡í•˜ì‹œê² ìŠµë‹ˆê¹Œ?","confirm-button-text":"ë“±ë¡","cancel-button-text":"ì·¨ì†Œ",onConfirm:W,onCancel:e[6]||(e[6]=s=>h.value=!1),onClose:e[7]||(e[7]=s=>h.value=!1),class:"modal-confirm-modal"},null,8,["is-visible"]),r(ye,{modelValue:S.value,"onUpdate:modelValue":e[8]||(e[8]=s=>S.value=s),type:"success"},{default:y(()=>[z(B($.value),1)]),_:1},8,["modelValue"]),r(we,{"is-visible":M.value,title:"ë‚ ì§œ ì„ íƒ",onClose:e[10]||(e[10]=s=>M.value=!1),onConfirm:e[11]||(e[11]=s=>I(m.value)),"is-show-confirm-button":!1,"is-show-cancel-button":!1},{content:y(()=>[r(A,{modelValue:m.value,"onUpdate:modelValue":[e[9]||(e[9]=s=>m.value=s),I],"show-header":!0,"show-navigation":!0,"show-calendar":!0,"show-time-picker":!1,"disabled-dates":se()},null,8,["modelValue","disabled-dates"])]),_:1},8,["is-visible"])]),_:1},8,["page-title"]))}}),Ye=me(Ie,[["__scopeId","data-v-371c9fc5"]]);export{Ye as default};
