import{g as E,c as g,o as y,a as u,b as w,_ as A,y as O,k as C,p as T,w as B,A as ee,t as S,m as te,F as V,h as q,n as ae,e as L,r as h,s as se,Z as oe,z as ie,q as ne,a1 as re}from"./DZksMEen.js";import{_ as le}from"./B73pkvVt.js";import{S as de}from"./CEowssdL.js";import{D as ce}from"./W2kn62HF.js";import{_ as ue}from"./DoybFlvs.js";import{B as ye}from"./DKYsh4JT.js";import{C as me}from"./CRAytAyU.js";import{D as he}from"./Bttyi2nK.js";import{B as ge}from"./BCB66FIC.js";import"./B9HIiqwO.js";import"./-lYuCJ0y.js";/* empty css        *//* empty css        *//* empty css        */import"./DNsJaZtH.js";/* empty css        */import"./SDSV116-.js";/* empty css        */const fe={class:"diary-calendar-section"},ve={class:"calendar-section"},pe=E({__name:"DiaryCalendarSection",props:{diaryData:{},disabledDates:{},showCalendar:{type:Boolean}},emits:["diary-click","date-change"],setup(b,{emit:_}){const m=_,f=o=>{m("diary-click",o)},c=o=>{m("date-change",o)};return(o,v)=>(y(),g("div",fe,[u("div",ve,[w(ce,{heartDiary:!0,heartDiaryData:o.diaryData,showHeader:!0,showNavigation:!0,"disabled-dates":o.disabledDates,showCalendar:o.showCalendar,onDiaryClick:f,onDateChange:c},null,8,["heartDiaryData","disabled-dates","showCalendar"])])]))}}),De=A(pe,[["__scopeId","data-v-6f31a4d6"]]),we=["id"],_e={class:"emoji-section"},ke=["src","alt"],Ce={class:"action-section"},be={key:0,class:"content-section"},$e={key:0,class:"daily-quote-content"},Me=["innerHTML"],Be={class:"diary-text"},Le={key:1},Te={class:"diary-text"},Se={key:2,class:"diary-images"},Ee=E({__name:"DiaryItem",props:{diary:{},variant:{default:"list"},showActions:{type:Boolean,default:!0}},emits:["showActions"],setup(b,{emit:_}){const m={diaryList:{slidesPerView:1,spaceBetween:10,pagination:!1,navigation:!1,loop:!1,showSlideLength:!1,showPlayPauseButton:!1}},f=b,c=O(),o=C(()=>f.diary.dailyQuoteQuestion?f.diary.dailyQuoteQuestion.replace(/<br\s*\/?>/gi," "):""),v=t=>t.isDailyQuote&&t.dailyQuoteQuestion||t.content,D=()=>{c.push(`/community/diary/${f.diary.id}`)};return(t,a)=>(y(),g("div",{id:`diary-${t.diary.date}`,class:"diary-item",onClick:D},[u("div",_e,[u("img",{src:t.diary.emoji.src,alt:t.diary.emoji.label},null,8,ke)]),u("div",Ce,[w(ye,{btnType:"icon",class:"action-btn",width:2,height:2,onClick:a[0]||(a[0]=ee(n=>t.$emit("showActions",t.diary),["stop"]))},{default:B(()=>a[1]||(a[1]=[u("i",{class:"icon ico-menu"},null,-1)])),_:1,__:[1]})]),v(t.diary)?(y(),g("div",be,[t.diary.isDailyQuote?(y(),g("div",$e,[a[2]||(a[2]=u("div",{class:"daily-quote-label"},"오늘 한마디",-1)),u("div",{class:"daily-quote-question",innerHTML:o.value},null,8,Me),u("p",Be,S(t.diary.content),1)])):(y(),g("div",Le,[u("div",Te,S(t.diary.content),1)])),t.diary.images&&t.diary.images.length>0?(y(),g("div",Se,[w(me,te({slides:t.diary.images,"slide-type":"image"},m.diaryList,{class:"diary-image-swiper"}),null,16,["slides"])])):T("",!0)])):T("",!0)],8,we))}}),Ie=A(Ee,[["__scopeId","data-v-ebffb2c2"]]),Ae={key:0,class:"diary-list-wrap"},je={class:"diary-entries"},Qe={key:1,class:"diary-list-wrap no-diary"},Fe=E({__name:"DiaryList",props:{diaryList:{},showCalendar:{type:Boolean},currentMonth:{},currentYear:{},highlightedDate:{}},emits:["edit","delete"],setup(b,{emit:_}){const m=b,f=C(()=>m.showCalendar?m.diaryList:m.diaryList.filter(t=>{const a=new Date(t.date);return a.getMonth()+1===m.currentMonth&&a.getFullYear()===m.currentYear})),c=C(()=>{const t=[],a={};f.value.forEach(i=>{const r=i.date;a[r]||(a[r]=[]),a[r].push(i)}),Object.keys(a).forEach(i=>{t.push({date:i,diaries:a[i]})});const n=new Date;return n.setHours(0,0,0,0),t.sort((i,r)=>{const p=new Date(i.date),k=new Date(r.date),$=Math.abs(p.getTime()-n.getTime()),M=Math.abs(k.getTime()-n.getTime());return $-M})});function o(t){const a=new Date(t);return["일","월","화","수","목","금","토"][a.getDay()]}function v(t){const a=new Date,n=new Date(t);return a.toDateString()===n.toDateString()}function D(t){const a=new Date(t),n=a.getMonth()+1,i=a.getDate(),r=o(t);return v(t)?`오늘 (${n}월 ${i}일 ${r}요일)`:`${n}월 ${i}일 ${r}요일`}return(t,a)=>c.value.length?(y(),g("div",Ae,[(y(!0),g(V,null,q(c.value,n=>(y(),g("div",{key:n.date,class:"date-group"},[u("div",{class:ae(["date-header",{today:v(n.date)}])},S(D(n.date)),3),u("div",je,[(y(!0),g(V,null,q(n.diaries,i=>(y(),L(Ie,{key:i.id,diary:i,highlighted:t.highlightedDate===i.date,onEdit:r=>t.$emit("edit",i),onShowActions:a[0]||(a[0]=r=>t.$emit("delete",r))},null,8,["diary","highlighted","onEdit"]))),128))])]))),128))])):(y(),g("div",Qe,a[1]||(a[1]=[u("div",{class:"no-diary-icon"},[u("img",{src:ue,alt:"일기 없음"})],-1),u("p",null,"작성된 일기가 없습니다.",-1)])))}}),N=A(Fe,[["__scopeId","data-v-bf462708"]]),He={class:"flex-1 mb-n20"},st=E({__name:"list",setup(b){const _=e=>(typeof e=="string"?new Date(e):e).toISOString().split("T")[0],m=O(),f=ne(),c=h(!0),o=h([]),v=h(new Date().getMonth()+1),D=h(new Date().getFullYear()),t=h(null),a=C(()=>{if(!t.value)return[];console.log("🔍 selectedDateForList.value:",t.value),console.log("🔍 diaryList.value:",o.value);const e=o.value.filter(s=>{const l=_(t.value),d=_(s.date);return console.log("🔍 비교:",d,"===",l,"결과:",d===l),console.log("🔍 diary 객체:",s),console.log("🔍 diary.images:",s.images),d===l});return console.log("🔍 필터링 결과:",e),console.log("🔍 필터링된 다이어리들의 이미지:",e.map(s=>({id:s.id,images:s.images}))),e}),n=C(()=>{const e={},s={};o.value.forEach(d=>{s[d.date]=(s[d.date]||0)+1});const l={};return o.value.forEach(d=>{l[d.date]||(l[d.date]=d)}),Object.keys(l).forEach(d=>{var H;const x=((H=l[d].emoji.src.split("/").pop())==null?void 0:H.replace(".svg",""))||"happy",G=s[d];e[d]={status:x,count:G}}),e}),i=h(null),r=h(!1),p=h(null),k=h(!1),$=h(!1),M=h(""),j=e=>{p.value=e,r.value=!0},P=()=>{r.value=!r.value},Y=()=>{r.value=!1,k.value=!0},R=()=>{k.value=!1,p.value=null},z=()=>{p.value&&(o.value=o.value.filter(e=>e.id!==p.value.id),localStorage.setItem("diaryList",JSON.stringify(o.value)),console.log("다이어리 삭제:",p.value.id),k.value=!1,p.value=null,Q("일기가 삭제되었습니다."))},Q=e=>{M.value=e,$.value=!0},K=()=>{try{const e=localStorage.getItem("diaryList");e&&(o.value=JSON.parse(e))}catch(e){console.error("다이어리 데이터 로드 실패:",e),o.value=[]}};function W(e){const s=new Date(e.dateKey),l=new Date;if(l.setHours(0,0,0,0),s.setHours(0,0,0,0),s>l){Q("앗, 미래일기는 기록할 수 없어요.");return}e.diaryInfo?(t.value=e.dateKey,i.value=e.dateKey):m.push({path:"/community/diary/create",query:{date:e.dateKey}})}function J(e){v.value=e.getMonth()+1,D.value=e.getFullYear()}function U(e){e&&(i.value=e,re(()=>{const s=document.getElementById(`diary-${e}`);s&&(s.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout(()=>{i.value=null},2e3))}))}function I(e){m.push({path:`/community/diary/${e.id}/edit`})}const Z=()=>{c.value=!c.value,c.value&&(t.value=null,i.value=null)},F=oe("setAddTextClickHandler"),X=C(()=>{const e=new Date,s=[];for(let l=1;l<=365;l++){const d=new Date(e);d.setDate(e.getDate()+l),s.push(d)}return console.log("🚫 비활성화된 날짜들:",s.length,"개"),console.log("🚫 첫 번째 비활성화 날짜:",s[0]),console.log("🚫 마지막 비활성화 날짜:",s[s.length-1]),s});return se(()=>{K(),F&&F(Z)}),ie(()=>f.query.scrollTo,(e,s)=>{e&&typeof e=="string"&&s!==void 0&&setTimeout(()=>{U(e)},100)}),(e,s)=>(y(),L(le,{"page-title":"마음 일기","show-back-button":!0,"has-add-text":!0,"add-text-click-enabled":!0,"add-text":c.value?"목록보기":"달력보기"},{default:B(()=>[w(de,{class:"ml-n20 mr-n20 pl-20 pr-20"},{default:B(()=>[w(De,{"diary-data":n.value,"disabled-dates":X.value,"show-calendar":c.value,onDiaryClick:W,onDateChange:J},null,8,["diary-data","disabled-dates","show-calendar"])]),_:1}),u("section",He,[c.value&&t.value?(y(),L(N,{key:0,"diary-list":a.value,"show-calendar":c.value,"current-month":v.value,"current-year":D.value,"highlighted-date":i.value,onEdit:I,onDelete:j},null,8,["diary-list","show-calendar","current-month","current-year","highlighted-date"])):T("",!0),c.value?T("",!0):(y(),L(N,{key:1,"diary-list":o.value,"show-calendar":c.value,"current-month":v.value,"current-year":D.value,"highlighted-date":i.value,onEdit:I,onDelete:j},null,8,["diary-list","show-calendar","current-month","current-year","highlighted-date"]))]),w(he,{"is-show-bottom-modal":r.value,"is-show-confirm-modal":k.value,"selected-diary":p.value,onClose:P,onEdit:I,onShowDeleteConfirm:Y,onConfirmDelete:z,onCancelDelete:R},null,8,["is-show-bottom-modal","is-show-confirm-modal","selected-diary"]),w(ge,{modelValue:$.value,"onUpdate:modelValue":s[0]||(s[0]=l=>$.value=l),type:"success",duration:3e3},{default:B(()=>[u("p",null,S(M.value),1)]),_:1},8,["modelValue"])]),_:1},8,["add-text"]))}});export{st as default};
